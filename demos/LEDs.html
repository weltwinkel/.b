<!DOCTYPE html>
<head>
    <title>databinding</title>
<script src="ext/jquery.js"></script>
<script src="../src/b.js"></script>
<script src="../src/b.binders.js"></script>
<script src="../src/b.formatters.js"></script>
<script src="../src/jQuery_b.js"></script>
</head>
<body>
<script>

// create objects
var devices = []; // create array where all devices are stored

var device = function(parameters){
	obj = this; // get instance
	for(var key in parameters){ // loop attributes
		obj[ key ] = parameters[ key ]; // set attribute
	}
	
	obj.id = devices.length;
	devices.push(obj);
};

var temp = new b.template();

// create the devices
for(var i = 0; i < 5500; i++){
	new device({alias : "Device " + i, status : 2});
	}


b.formatters.LED =  function(params){
		
        var col; // color
        switch(params[0].object[ params[0].param ]){
                case 1: col = "#ccc"; break;
                case 2: col = "red"; break;
                case 3: col = "yellow"; break;
                case 4: col = "#60E065"; break;
                case 5: col = "orange"; break;
                case 8: col = "blue"; break;
                default : col = "#fff";
        }
        params.formatted = "<span style='width:16px; height:16px; background:" + col + "; display:block; border-radius:8px;'></span>";
        return params;

};

$(function(){

	// loop devices and create them using jQuery_b
	devices.forEach(function(device){
	
		var el = $("<div>").appendTo("body");
		temp.b(el[0],{html : "dev.status:LED"},{dev : device});
		});
});


window.setInterval(function(){

	devices.forEach(function(device){
		var stat = Math.round(Math.random()*6);
		device._set("status", stat );
		});
	},1000);

</script>
<style>
body > div{margin:1px; float:left;}

.OK{background-color:#d1ee63 !important}
.GuessOk{background-color:#eeffaa !important}
.Unknown{background-color:#f2f2f2 !important}
.Warning{background-color:#ffff80 !important}
.Minor{background-color:#fdc375 !important}
.Major{background-color:#ff8a8a !important}
.Critical{background-color:#ff5555 !important}

</style>
</body>
</html>